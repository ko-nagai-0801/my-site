/* app/globals.css */
@import "tailwindcss";
@plugin "@tailwindcss/typography";

/* -----------------------------
   Theme tokens = 色の設計図
   - 意味(役割)を固定し、dark/light で値だけ切り替える
----------------------------- */
:root {
  /* base */
  --background: #0b0b0b;
  --foreground: #f2f2f2;

  /* text roles */
  --muted: color-mix(in oklab, var(--foreground) 72%, var(--background));
  --subtle: color-mix(in oklab, var(--foreground) 55%, var(--background));

  /* surfaces / borders */
  --border: color-mix(in oklab, var(--foreground) 14%, var(--background));
  --panel: color-mix(in oklab, var(--foreground) 6%, var(--background));
  --panel-2: color-mix(in oklab, var(--foreground) 9%, var(--background));

  /* accent (links) */
  --link: #7dd3fc;       /* dark: ほんのり青 */
  --link-hover: #38bdf8; /* dark: 少し濃く */

  /* focus / selection */
  --ring: color-mix(in oklab, var(--link) 55%, transparent);
  --selection: color-mix(in oklab, var(--link) 22%, transparent);

  /* code */
  --code: color-mix(in oklab, var(--foreground) 92%, var(--background));
  --code-bg: color-mix(in oklab, var(--panel) 88%, var(--background));
  --pre-bg: color-mix(in oklab, var(--panel) 78%, var(--background));
  --pre-border: color-mix(in oklab, var(--border) 85%, var(--background));

  /* shadows / overlay */
  --shadow-1: 0 1px 0 0 color-mix(in oklab, var(--foreground) 8%, transparent),
              0 12px 28px -20px color-mix(in oklab, var(--foreground) 18%, transparent);
  --hero-overlay: linear-gradient(
    to bottom,
    color-mix(in oklab, #000 65%, transparent),
    color-mix(in oklab, #000 35%, transparent)
  );

  color-scheme: dark;
}

@media (prefers-color-scheme: light) {
  :root {
    --background: #fbfbf8;
    --foreground: #121212;

    /* light: 同じ“意味”で値だけ調整 */
    --link: #0284c7;
    --link-hover: #0369a1;

    /* lightだと影が濁りやすいので少し締める */
    --shadow-1: 0 1px 0 0 color-mix(in oklab, #000 6%, transparent),
                0 16px 32px -26px color-mix(in oklab, #000 20%, transparent);

    /* lightのヒーローは「暗くし過ぎない」方向へ */
    --hero-overlay: linear-gradient(
      to bottom,
      color-mix(in oklab, #000 40%, transparent),
      color-mix(in oklab, #000 18%, transparent)
    );

    color-scheme: light;
  }
}

/* Tailwind theme bridge（bg-background / text-foreground などに接続） */
@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);

  --color-muted: var(--muted);
  --color-subtle: var(--subtle);

  --color-border: var(--border);
  --color-panel: var(--panel);
  --color-panel-2: var(--panel-2);

  --color-link: var(--link);
  --color-link-hover: var(--link-hover);

  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

@layer base {
  html {
    -webkit-text-size-adjust: 100%;
  }

  body {
    background: var(--background);
    color: var(--foreground);
    font-family: var(--font-sans), system-ui, -apple-system, "Segoe UI",
      "Hiragino Sans", "Noto Sans JP", Arial, sans-serif;
    text-rendering: optimizeLegibility;
    min-height: 100dvh;
  }

  a {
    color: var(--link);
    text-underline-offset: 0.22em;
    text-decoration-thickness: 1px;
  }
  a:hover {
    color: var(--link-hover);
  }

  :focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 3px;
  }

  ::selection {
    background: var(--selection);
  }
}

@layer components {
  /* ページ共通の横幅と余白 */
  .container {
    @apply mx-auto w-full max-w-5xl px-6;
  }

  /* nav: muted前提で統一 */
  .nav-link {
    @apply text-xs tracking-[0.22em] uppercase text-muted hover:text-foreground;
  }

  /* hairline: borderトークンで統一 */
  .hairline {
    @apply border-b;
    border-color: var(--border);
  }

  /* card/surface: 今後のCardsはこれに寄せる */
  .panel {
    background: var(--panel);
    border: 1px solid var(--border);
    box-shadow: var(--shadow-1);
    border-radius: 16px;
  }

  /* サブテキストの共通化（日時など） */
  .text-muted {
    color: var(--muted);
  }
  .text-subtle {
    color: var(--subtle);
  }
}

/* -----------------------------
   Typography（MDX / prose）
   - dark/light で破綻しない “読み設計”
----------------------------- */
@layer base {
  .prose {
    --tw-prose-body: var(--foreground);
    --tw-prose-headings: var(--foreground);
    --tw-prose-lead: var(--muted);
    --tw-prose-links: var(--link);
    --tw-prose-bold: var(--foreground);
    --tw-prose-counters: var(--muted);
    --tw-prose-bullets: var(--muted);
    --tw-prose-hr: var(--border);
    --tw-prose-quotes: var(--foreground);
    --tw-prose-quote-borders: var(--border);
    --tw-prose-captions: var(--subtle);
    --tw-prose-code: var(--code);
    --tw-prose-pre-code: var(--foreground);
    --tw-prose-pre-bg: var(--pre-bg);
    --tw-prose-th-borders: var(--border);
    --tw-prose-td-borders: var(--border);
  }

  /* inline code（pre以外） */
  .prose :not(pre) > code {
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.12em 0.42em;
    font-family: var(--font-mono), ui-monospace, SFMono-Regular, Menlo, monospace;
    font-size: 0.92em;
  }
  .prose :not(pre) > code::before,
  .prose :not(pre) > code::after {
    content: "";
  }

  /* code block */
  .prose pre {
    border: 1px solid var(--pre-border);
    border-radius: 16px;
  }

  /* blockquote */
  .prose blockquote {
    border-left-color: var(--border);
    color: var(--muted);
  }

  /* tables */
  .prose table {
    border-color: var(--border);
  }
}
